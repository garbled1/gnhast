<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Tim Rightnour">
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>Ideas - gnhast</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">gnhast</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../screenshots/">Screenshots</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../start/">The Basics</a>
</li>

                        
                            
<li class="active">
    <a href="./">Ideas</a>
</li>

                        
                            
<li >
    <a href="../collectors/">The Collectors</a>
</li>

                        
                            
<li >
    <a href="../dependencies/">Dependencies</a>
</li>

                        
                            
<li >
    <a href="../protocol/">Protocol Design</a>
</li>

                        
                            
<li >
    <a href="../gnhastweb/">GnhastWeb</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Programming Gnhast <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../subtype/">Adding a new subtype</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Configuration <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../config/device/">device section</a>
</li>

                        
                            
<li >
    <a href="../config/gnhastd_sec/">gnhastd section</a>
</li>

                        
                            
<li >
    <a href="../config/brulcoll/">brulcoll.conf</a>
</li>

                        
                            
<li >
    <a href="../config/insteon/">Insteon</a>
</li>

                        
                            
<li >
    <a href="../config/gnhastd/">gnhastd.conf</a>
</li>

                        
                            
<li >
    <a href="../config/owsrvcoll/">owsrvcoll.conf</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../start/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../collectors/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/garbled1/gnhast/">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#timers">Timers</a></li>
        
    
        <li class="main "><a href="#example-handlers">Example handlers</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="timers">Timers</h3>
<p>For example, you want a light to turn on every night at 1am, and turn off at 2 am.  Rather than build a timer system into gnhast, the UNIX way to accomplish this, is to simply setup a cronjob. The handlers directory provides a switchon/switchoff handler.  So we might setup a cron like so:</p>
<pre><code>    0 1 * * * /usr/local/libexec/gnhast/switchon 4A:5C:44=switch
    0 2 * * * /usr/local/libexec/gnhast/switchoff 4A:5C:44=switch
</code></pre>

<p>But what if we want to do something more complex?  Like maybe we want a light to be activated by a handler, like a motion sensor, but then shut off in 15 minutes.  (I'll have to write a good example handler for this, it's easy enough to do).  We write a handler script that turns the light on, and then immediately schedules an atjob 15 minutes out to run the "switchoff" handler.</p>
<h3 id="example-handlers">Example handlers</h3>
<p>The handlers directory contains a few example, and perfectly usable handlers.  One such handler is the "nightlight".  This is a simple handler that responds to a lux sensor, and is used to turn lights on and off.  You can set this handler up very simply.</p>
<p>First, find your lux sensor in the devices.conf file, and add the full path to the nightlight script to the handler config entry.  Then, set hargs to a comma separated list of the devices you wish to turn on/off with the result of the sensor.  Finally, set the lux level that will activate the threshold in hiwat and lowat.  Make sure you edit the threshold in the nightlight script to match this.</p>
<pre><code>    device &quot;26.A43328010000&quot; {
    name = &quot;Outside LUX&quot;
    handler = &quot;/usr/local/libexec/gnhast/nightlight&quot;
    hargs = {&quot;25.98.9B&quot;, &quot;25.9B.6D&quot;}
    spamhandler = no
    hiwat = 250.000000
    lowat = 250.000000
    }
</code></pre>

<p>The spamhandler directive, when set to yes, will call the handler every time the device updates above or below the water mark. When set to no, it will only call when a device crosses a water mark.</p>
<p>So, in the above example, when the light level crosses 250, nightlight will be called, and if it's above 250, it will turn the devices in hargs off, and if below, it will turn them on.</p>
<p>This script could easily be rewritten to accomodate other sensor types. For example, you could use a wind sensor's speed to determine if you should raise an outdoor shade to prevent damage to it.  Set a high watermark, of say 10 (mph) and then have it activate the device that raises the shade.</p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
